/*!
 * 
 * blue-retreat.js 1.0.5
 * (c) 2016-2022 Blue
 * Released under the MIT License.
 * https://github.com/azhanging/blue-retreat
 * time:Sat, 03 Sep 2022 11:37:12 GMT
 * 
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.BlueRetreat=e():t.BlueRetreat=e()}("undefined"!=typeof self?self:this,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var u=e[r]={i:r,l:!1,exports:{}};return t[r].call(u.exports,u,u.exports,n),u.l=!0,u.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var u in t)n.d(r,u,function(e){return t[e]}.bind(null,u));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="./static",n(n.s=0)}([function(t,e,n){"use strict";n.r(e),n.d(e,"defineBlueRetreat",function(){return E}),n.d(e,"getExcludeState",function(){return m});var r=n(1),u=n(2),o=n(3),i=n(4);n.d(e,"setRetreatData",function(){return r.setRetreatData}),n.d(e,"resetRetreatData",function(){return r.resetRetreatData}),n.d(e,"getCurrentRetreatData",function(){return r.getCurrentRetreatData}),n.d(e,"getRetreatData",function(){return r.getRetreatData});var a,c=50,f=[],s=null,d=null,l=null,E=(a=!1,function(t){if(!a){var e=t.router,n=t.store;if(!e||!n)return console.log("blue-retreat init error,please required set Vue Router and (Vuex|Pinia) in options");l=e,d=i.storeRegister(n),l.beforeEach(function(t,e,n){!function(t){var e=t.to,n=t.next,r=Object(u.getRouteName)(e);if(r===s)return s=null,n();s=null;var o=function(){var t=Object(u.getRouteMatchedNames)(e),n=function(t){var e=[];return f.forEach(function(n){var r=n.matchedNames;r.includes(t)&&r.forEach(function(t){e.includes(t)||e.push(t)})}),e}(r);return n.length>t.length?n:t}(),i=m();i.push.apply(i,o),p(i),setTimeout(function(){p([]),function(t){function e(t){for(var e=function(t){void 0===t&&(t={});var e=t.name,n=[];return e?(f.forEach(function(t){t.name===e&&n.push(t)}),n):n}({name:t});e.length;){var n=e.length-1,r=f.indexOf(e[n]);f.splice(r,1),e.pop()}}"string"==typeof t?e(t):t instanceof Array&&t.forEach(function(t){e(t)})}(o),n()},c)}({to:t,from:e,next:n})}),l.afterEach(function(){setTimeout(function(){!function(){var t=history.state,e=Object(u.getStateKey)(t);if(l&&(e||0===e)&&!v({key:e})){var n=Object(u.unref)(l.currentRoute),r=Object(u.getRouteName)(n),o=Object(u.getRouteMatchedNames)(n);r&&f.push({key:e,name:r,matchedNames:o})}}()},c)}),a=!0}});function p(t){var e=Object.assign([],t);i.isPinia?d.exclude=e:i.isVuex&&d.commit(o.SET_KEEP_ALIVE_EXCLUDE,e)}function v(t){void 0===t&&(t={});for(var e=t.type,n=void 0===e?"current":e,r=t.findIndex,u=void 0!==r&&r,o=t.key,i=0;i<f.length;i++){var a=f[i],c=f[i+1];if(a.key===o&&"next"===n&&c)return u?i+1:c;if(a.key===o&&"current"===n)return u?i:a}return u?-1:null}function m(){var t=[];if(d){if(i.isPinia)return d.exclude||t;if(i.isVuex)return d.state[o.STORE_MODULE_NAME].exclude||t}return t}window.addEventListener("popstate",function(t){t.state||(t.state={}),t.state.retreatData=Object(r.getCurrentRetreatData)();var e=t.state,n=Object(u.getStateKey)(e),o=v({key:n}),i=v({key:n,type:"next"});if(s=o?o.name:null,null===o&&f.length>0&&(i=f[f.length-1]),i){var a=i,d=a.name,l=a.key,E=m();E.push(d),p(E),setTimeout(function(){var t;p([]),-1!==(t=v({key:l,findIndex:!0}))&&f.splice(t,1)},c)}})},function(t,e,n){"use strict";n.r(e),n.d(e,"setRetreatData",function(){return u}),n.d(e,"resetRetreatData",function(){return o}),n.d(e,"getCurrentRetreatData",function(){return i}),n.d(e,"getRetreatData",function(){return a});var r={};function u(t){r=t}function o(){r={}}function i(){return r}function a(t){void 0===t&&(t={});var e=t.once,n=r;return(void 0===e||e)&&o(),n}},function(t,e,n){"use strict";function r(t){return function(t){return t.__v_isRef}(t)?t.value:t}function u(t){return t.key||t.position||""}function o(t){var e=t.meta;return(void 0===e?{}:e).name||t.name||""}function i(t){return t.matched.map(function(t){return t.name||t.meta&&t.meta.name||""})}n.r(e),n.d(e,"unref",function(){return r}),n.d(e,"getStateKey",function(){return u}),n.d(e,"getRouteName",function(){return o}),n.d(e,"getRouteMatchedNames",function(){return i})},function(t,e,n){"use strict";n.r(e),n.d(e,"SET_KEEP_ALIVE_EXCLUDE",function(){return r}),n.d(e,"STORE_MODULE_NAME",function(){return u});var r="SET_KEEP_ALIVE_EXCLUDE",u="KEEP_ALIVE"},function(t,e,n){"use strict";n.r(e),n.d(e,"isPinia",function(){return u}),n.d(e,"isVuex",function(){return o}),n.d(e,"storeRegister",function(){return i});var r=n(3),u=!1,o=!1;function i(t){return"function"==typeof t?function(t){var e=t(r.STORE_MODULE_NAME,{state:function(){return{exclude:[]}}});(t=e())&&t.$id?u=!0:(t=null,console.error("store is not Pinia"));return t}(t):function(t){var e;return t.registerModule(r.STORE_MODULE_NAME,{state:{exclude:[]},mutations:(e={},e[r.SET_KEEP_ALIVE_EXCLUDE]=function(t,e){t[r.STORE_MODULE_NAME]=e},e)}),o=!0,t}(t)}}])});
//# sourceMappingURL=blue-retreat.min.js.map