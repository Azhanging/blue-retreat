/*!
 * 
 * blue-retreat.js 1.0.3
 * (c) 2016-2022 Blue
 * Released under the MIT License.
 * https://github.com/azhanging/blue-retreat
 * time:Mon, 29 Aug 2022 16:40:07 GMT
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.BlueRetreat=t():e.BlueRetreat=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var u=t[r]={i:r,l:!1,exports:{}};return e[r].call(u.exports,u,u.exports,n),u.l=!0,u.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var u in e)n.d(r,u,function(t){return e[t]}.bind(null,u));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="./static",n(n.s=0)}([function(e,t,n){"use strict";n.r(t),n.d(t,"initBlueRetreat",function(){return p}),n.d(t,"getExcludeState",function(){return x});var r=n(1);n.d(t,"setRetreatData",function(){return r.setRetreatData}),n.d(t,"resetRetreatData",function(){return r.resetRetreatData}),n.d(t,"getCurrentRetreatData",function(){return r.getCurrentRetreatData}),n.d(t,"getRetreatData",function(){return r.getRetreatData});var u="SET_KEEP_ALIVE_EXCLUDE",o="KEEP_ALIVE",i=[],a=null,f=null,c=null,l=!1,s=!1;var d,p=(d=!1,function(e){if(!d){var t,n,r=e.router,p=e.store;if(!r||!p)return console.log("blue-retreat init error,please required set Vue Router and (Vuex|Pinia) in options");c=r,"function"==typeof(f=p)?(n=f(o,{state:function(){return{exclude:[]}}}),(f=n())&&f.$id?l=!0:(f=null,new Error("store is not Pinia"))):(f.registerModule(o,{state:{exclude:[]},mutations:(t={},t[u]=function(e,t){e[o]=t},t)}),s=!0),c.beforeEach(function(e,t,n){!function(e){var t=e.to,n=(e.from,e.next),r=t.meta.name;if(r===a)return n();if(a=null,0===m({name:r}).length)return n();var u=x();u.includes(r)?n():(u.push(r),v(u),setTimeout(function(){var e=x(),t=e.indexOf(r);-1!==t&&e.splice(t,1),v(e),function(e){for(var t=m({name:e.name});t.length;){var n=i.indexOf(t[t.length-1]);i.splice(n,1),t.pop()}}({name:r}),n()}))}({to:e,from:t,next:n})}),c.afterEach(function(){setTimeout(function(){!function(){var e=history.state,t=e.key||e.position;if(c&&t&&!y({key:t})){var n,r=(n=c.currentRoute,function(e){return e.__v_isRef}(n)?n.value:n).meta.name;r&&i.push({key:t,name:r,time:+new Date})}}()})}),d=!0}});function v(e){var t=Object.assign([],e);l?f.exclude=t:f.commit(u,t)}function y(e){void 0===e&&(e={});for(var t=e.type,n=void 0===t?"current":t,r=e.findIndex,u=void 0!==r&&r,o=e.key,a=0;a<i.length;a++){var f=i[a],c=i[a+1];if(f.key===o&&"next"===n&&c)return u?a:c;if(f.key===o&&"current"===n)return u?a:f}return u?-1:null}function m(e){void 0===e&&(e={});var t=e.name,n=[];return t?(i.forEach(function(e){e.name===t&&n.push(e)}),n):n}function x(){var e=[];if(f){if(l)return f.exclude||e;if(s)return f.state[o].exclude||e}return e}window.addEventListener("popstate",function(e){e.state||(e.state={}),e.state.retreatData=Object(r.getCurrentRetreatData)();var t=e.state,n=t.key||t.position,u=y({key:n,type:"next"}),o=y({key:n});if(a=o?o.name:null,null===o&&i.length>0&&(u=i[i.length-1]),u){var f=u,c=f.name,l=f.key,s=x();if(s.includes(c))return;s.push(c),v(s),setTimeout(function(){var e=x(),t=e.indexOf(c);-1!==t&&e.splice(t,1),v(e);var n=y({key:l,findIndex:!0});-1!==n&&i.splice(n,1)},50)}})},function(e,t,n){"use strict";n.r(t),n.d(t,"setRetreatData",function(){return u}),n.d(t,"resetRetreatData",function(){return o}),n.d(t,"getCurrentRetreatData",function(){return i}),n.d(t,"getRetreatData",function(){return a});var r={};function u(e){r=e}function o(){r={}}function i(){return r}function a(e){void 0===e&&(e={});var t=e.once,n=r;return(void 0===t||t)&&o(),n}}])});
//# sourceMappingURL=blue-retreat.min.js.map