/*!
 * 
 * blue-retreat.js 1.0.4
 * (c) 2016-2022 Blue
 * Released under the MIT License.
 * https://github.com/azhanging/blue-retreat
 * time:Tue, 30 Aug 2022 16:01:18 GMT
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.BlueRetreat=t():e.BlueRetreat=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var u=t[r]={i:r,l:!1,exports:{}};return e[r].call(u.exports,u,u.exports,n),u.l=!0,u.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var u in e)n.d(r,u,function(t){return e[t]}.bind(null,u));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="./static",n(n.s=0)}([function(e,t,n){"use strict";n.r(t),n.d(t,"defineBlueRetreat",function(){return d}),n.d(t,"getExcludeState",function(){return y});var r=n(1),u=n(2),i=n(3),o=n(4);n.d(t,"setRetreatData",function(){return r.setRetreatData}),n.d(t,"resetRetreatData",function(){return r.resetRetreatData}),n.d(t,"getCurrentRetreatData",function(){return r.getCurrentRetreatData}),n.d(t,"getRetreatData",function(){return r.getRetreatData});var a,f=[],c=null,s=null,l=null,d=(a=!1,function(e){if(!a){var t=e.router,n=e.store;if(!t||!n)return console.log("blue-retreat init error,please required set Vue Router and (Vuex|Pinia) in options");l=t,s=o.storeRegister(n),l.beforeEach(function(e,t,n){!function(e){var t=e.to,n=e.next,r=t.meta.name;if(r===c)return n();if(c=null,0===v({name:r}).length)return n();var u=y();u.includes(r)?n():(u.push(r),E(u),setTimeout(function(){var e=y(),t=e.indexOf(r);-1!==t&&e.splice(t,1),E(e),function(e){for(var t=v({name:e.name});t.length;){var n=f.indexOf(t[t.length-1]);f.splice(n,1),t.pop()}}({name:r}),n()}))}({to:e,from:t,next:n})}),l.afterEach(function(){setTimeout(function(){!function(){var e=history.state,t=Object(u.getStateKey)(e);if(l&&(t||0===t)&&!p({key:t})){var n=l.currentRoute,r=Object(u.unref)(n).meta.name;r&&f.push({key:t,name:r})}}()})}),a=!0}});function E(e){var t=Object.assign([],e);o.isPinia?s.exclude=t:o.isVuex&&s.commit(i.SET_KEEP_ALIVE_EXCLUDE,t)}function p(e){void 0===e&&(e={});for(var t=e.type,n=void 0===t?"current":t,r=e.findIndex,u=void 0!==r&&r,i=e.key,o=0;o<f.length;o++){var a=f[o],c=f[o+1];if(a.key===i&&"next"===n&&c)return u?o:c;if(a.key===i&&"current"===n)return u?o:a}return u?-1:null}function v(e){void 0===e&&(e={});var t=e.name,n=[];return t?(f.forEach(function(e){e.name===t&&n.push(e)}),n):n}function y(){var e=[];if(s){if(o.isPinia)return s.exclude||e;if(o.isVuex)return s.state[i.STORE_MODULE_NAME].exclude||e}return e}window.addEventListener("popstate",function(e){e.state||(e.state={}),e.state.retreatData=Object(r.getCurrentRetreatData)();var t=e.state,n=Object(u.getStateKey)(t),i=p({key:n,type:"next"}),o=p({key:n});if(c=o?o.name:null,null===o&&f.length>0&&(i=f[f.length-1]),i){var a=i,s=a.name,l=a.key,d=y();if(d.includes(s))return;d.push(s),E(d),setTimeout(function(){var e=y(),t=e.indexOf(s);-1!==t&&e.splice(t,1),E(e);var n=p({key:l,findIndex:!0});-1!==n&&f.splice(n,1)},50)}})},function(e,t,n){"use strict";n.r(t),n.d(t,"setRetreatData",function(){return u}),n.d(t,"resetRetreatData",function(){return i}),n.d(t,"getCurrentRetreatData",function(){return o}),n.d(t,"getRetreatData",function(){return a});var r={};function u(e){r=e}function i(){r={}}function o(){return r}function a(e){void 0===e&&(e={});var t=e.once,n=r;return(void 0===t||t)&&i(),n}},function(e,t,n){"use strict";function r(e){return function(e){return e.__v_isRef}(e)?e.value:e}function u(e){return e.key||e.position||""}n.r(t),n.d(t,"unref",function(){return r}),n.d(t,"getStateKey",function(){return u})},function(e,t,n){"use strict";n.r(t),n.d(t,"SET_KEEP_ALIVE_EXCLUDE",function(){return r}),n.d(t,"STORE_MODULE_NAME",function(){return u});var r="SET_KEEP_ALIVE_EXCLUDE",u="KEEP_ALIVE"},function(e,t,n){"use strict";n.r(t),n.d(t,"isPinia",function(){return u}),n.d(t,"isVuex",function(){return i}),n.d(t,"storeRegister",function(){return o});var r=n(3),u=!1,i=!1;function o(e){return"function"==typeof e?function(e){var t=e(r.STORE_MODULE_NAME,{state:function(){return{exclude:[]}}});(e=t())&&e.$id?u=!0:(e=null,console.error("store is not Pinia"));return e}(e):function(e){var t;return e.registerModule(r.STORE_MODULE_NAME,{state:{exclude:[]},mutations:(t={},t[r.SET_KEEP_ALIVE_EXCLUDE]=function(e,t){e[r.STORE_MODULE_NAME]=t},t)}),i=!0,e}(e)}}])});
//# sourceMappingURL=blue-retreat.min.js.map