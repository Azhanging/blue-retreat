/*!
 * 
 * blue-retreat.js 1.0.3
 * (c) 2016-2021 Blue
 * Released under the MIT License.
 * https://github.com/azhanging/blue-retreat
 * time:Mon, 20 Dec 2021 15:01:18 GMT
 * 
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.BlueRetreat=t():e.BlueRetreat=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var u=t[r]={i:r,l:!1,exports:{}};return e[r].call(u.exports,u,u.exports,n),u.l=!0,u.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var u in e)n.d(r,u,function(t){return e[t]}.bind(null,u));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="./static",n(n.s=0)}([function(e,t,n){"use strict";n.r(t),n.d(t,"initBlueRetreat",function(){return s}),n.d(t,"getExcludeState",function(){return m});var r=n(1);n.d(t,"setRetreatData",function(){return r.setRetreatData}),n.d(t,"resetRetreatData",function(){return r.resetRetreatData}),n.d(t,"getCurrentRetreatData",function(){return r.getCurrentRetreatData}),n.d(t,"getRetreatData",function(){return r.getRetreatData});var u,o="SET_KEEP_ALIVE_EXCLUDE",a="KEEP_ALIVE",i=[],f=null,c=null,l=null,s=(u=!1,function(e){if(!u){var t,n=e.router,r=e.store;if(!n||!r)return console.log("blue-retreat init error,please required set Vue Router and Vuex in options");l=n,(c=r).registerModule(a,{state:{exclude:[]},mutations:(t={},t[o]=function(e,t){e[a]=t},t)}),l.beforeEach(function(e,t,n){!function(e){var t=e.to,n=(e.from,e.next),r=t.meta.name;if(r===f)return n();if(f=null,0===v({name:r}).length)return n();var u=m();u.includes(r)?n():(u.push(r),d(u),setTimeout(function(){var e=m(),t=e.indexOf(r);-1!==t&&e.splice(t,1),d(e),function(e){for(var t=v({name:e.name});t.length;){var n=i.indexOf(t[t.length-1]);i.splice(n,1),t.pop()}}({name:r}),n()}))}({to:e,from:t,next:n})}),l.afterEach(function(){setTimeout(function(){!function(){var e=history.state.key;if(l&&e&&!p({key:e})){var t=l.currentRoute.meta.name;t&&i.push({key:e,name:t,time:+new Date})}}()})}),u=!0}});function d(e){c.commit(o,Object.assign([],e))}function p(e){void 0===e&&(e={});for(var t=e.type,n=void 0===t?"current":t,r=e.findIndex,u=void 0!==r&&r,o=e.key,a=0;a<i.length;a++){var f=i[a],c=i[a+1];if(f.key===o&&"next"===n&&c)return u?a:c;if(f.key===o&&"current"===n)return u?a:f}return u?-1:null}function v(e){void 0===e&&(e={});var t=e.name,n=[];return t?(i.forEach(function(e){e.name===t&&n.push(e)}),n):n}function m(){return c.state[a].exclude||[]}window.addEventListener("popstate",function(e){e.state||(e.state={}),e.state.retreatData=Object(r.getCurrentRetreatData)();var t=e.state.key,n=p({key:t,type:"next"}),u=p({key:t});if(f=u?u.name:null,null===u&&i.length>0&&(n=i[i.length-1]),n){var o=n,a=o.name,c=o.key,l=m();if(l.includes(a))return;l.push(a),d(l),setTimeout(function(){var e=m(),t=e.indexOf(a);-1!==t&&e.splice(t,1),d(e);var n=p({key:c,findIndex:!0});-1!==n&&i.splice(n,1)},50)}})},function(e,t,n){"use strict";n.r(t),n.d(t,"setRetreatData",function(){return u}),n.d(t,"resetRetreatData",function(){return o}),n.d(t,"getCurrentRetreatData",function(){return a}),n.d(t,"getRetreatData",function(){return i});var r={};function u(e){r=e}function o(){r={}}function a(){return r}function i(e){void 0===e&&(e={});var t=e.once,n=r;return(void 0===t||t)&&o(),n}}])});
//# sourceMappingURL=blue-retreat.min.js.map